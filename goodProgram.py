import os
import time
from winreg import *


def is_windows():
    return os.name == 'nt'


def readRegistry():
    registry = ConnectRegistry(None, HKEY_LOCAL_MACHINE)

    rawKeyA = OpenKey(registry, "SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System")

    try:
        i = 0
        while 1:
            name, value, type = EnumValue(rawKeyA, i)
            print(name, value, i)
            i += 1

    except WindowsError:
        print("END")

    CloseKey(rawKeyA)


if __name__ == '__main__':
    if is_windows():
        readRegistry()
    else:
        print("You're not windows!")

    print("sleeping for 5 seconds...")
    time.sleep(5)
